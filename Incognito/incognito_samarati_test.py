#!/usr/bin/env python3

from incognito import *
from utils import *
import datetime

import pandas as pd

data = pd.read_csv("./test_data/samarati_big_data",header=0, dtype=str)

# Generalization Trees: race, birthdate, sex, zipcode, status

# race
race_tree = GeneralizationTreeNode("person")
race_tree.add_son("person","asian")
race_tree.add_son("person","black")
race_tree.add_son("person","white")

# birthdate
birthdate_tree = GeneralizationTreeNode("*/*/*")
birthdate_tree.add_son("*/*/*","*/*/64")
birthdate_tree.add_son("*/*/*","*/*/63")
birthdate_tree.add_son("*/*/*","*/*/61")

birthdate_tree.add_son("*/*/64","*/27/64")
birthdate_tree.add_son("*/*/64","*/30/64")
birthdate_tree.add_son("*/*/64","*/18/64")
birthdate_tree.add_son("*/*/64","*/15/64")
birthdate_tree.add_son("*/*/64","*/13/64")
birthdate_tree.add_son("*/*/64","*/28/64")
birthdate_tree.add_son("*/*/64","*/06/64")
birthdate_tree.add_son("*/*/64","*/29/64")
birthdate_tree.add_son("*/*/64","*/05/64")
birthdate_tree.add_son("*/*/64","*/03/64")
birthdate_tree.add_son("*/*/64","*/20/64")
birthdate_tree.add_son("*/*/64","*/11/64")
birthdate_tree.add_son("*/*/64","*/12/64")
birthdate_tree.add_son("*/*/64","*/10/64")
birthdate_tree.add_son("*/*/64","*/08/64")
birthdate_tree.add_son("*/*/64","*/19/64")
birthdate_tree.add_son("*/*/64","*/09/64")
birthdate_tree.add_son("*/*/64","*/23/64")
birthdate_tree.add_son("*/*/64","*/04/64")
birthdate_tree.add_son("*/*/64","*/16/64")
birthdate_tree.add_son("*/*/64","*/21/64")
birthdate_tree.add_son("*/*/64","*/25/64")
birthdate_tree.add_son("*/*/64","*/07/64")
birthdate_tree.add_son("*/*/64","*/14/64")
birthdate_tree.add_son("*/*/64","*/26/64")
birthdate_tree.add_son("*/*/64","*/24/64")
birthdate_tree.add_son("*/*/64","*/17/64")
birthdate_tree.add_son("*/*/64","*/22/64")
birthdate_tree.add_son("*/*/64","*/02/64")
birthdate_tree.add_son("*/*/64","*/01/64")

birthdate_tree.add_son("*/*/63","*/13/63")
birthdate_tree.add_son("*/*/63","*/18/63")
birthdate_tree.add_son("*/*/63","*/05/63")
birthdate_tree.add_son("*/*/63","*/11/63")
birthdate_tree.add_son("*/*/63","*/15/63")
birthdate_tree.add_son("*/*/63","*/07/63")
birthdate_tree.add_son("*/*/63","*/06/63")
birthdate_tree.add_son("*/*/63","*/19/63")
birthdate_tree.add_son("*/*/63","*/27/63")
birthdate_tree.add_son("*/*/63","*/28/63")
birthdate_tree.add_son("*/*/63","*/30/63")
birthdate_tree.add_son("*/*/63","*/09/63")
birthdate_tree.add_son("*/*/63","*/04/63")
birthdate_tree.add_son("*/*/63","*/08/63")
birthdate_tree.add_son("*/*/63","*/17/63")
birthdate_tree.add_son("*/*/63","*/01/63")
birthdate_tree.add_son("*/*/63","*/10/63")
birthdate_tree.add_son("*/*/63","*/14/63")
birthdate_tree.add_son("*/*/63","*/16/63")
birthdate_tree.add_son("*/*/63","*/25/63")
birthdate_tree.add_son("*/*/63","*/03/63")
birthdate_tree.add_son("*/*/63","*/22/63")
birthdate_tree.add_son("*/*/63","*/02/63")
birthdate_tree.add_son("*/*/63","*/29/63")
birthdate_tree.add_son("*/*/63","*/23/63")
birthdate_tree.add_son("*/*/63","*/26/63")
birthdate_tree.add_son("*/*/63","*/12/63")
birthdate_tree.add_son("*/*/63","*/24/63")
birthdate_tree.add_son("*/*/63","*/21/63")
birthdate_tree.add_son("*/*/63","*/20/63")
birthdate_tree.add_son("*/*/63","*/31/63")

birthdate_tree.add_son("*/*/61","*/14/61")
birthdate_tree.add_son("*/*/61","*/08/61")
birthdate_tree.add_son("*/*/61","*/09/61")
birthdate_tree.add_son("*/*/61","*/05/61")
birthdate_tree.add_son("*/*/61","*/15/61")
birthdate_tree.add_son("*/*/61","*/26/61")
birthdate_tree.add_son("*/*/61","*/06/61")
birthdate_tree.add_son("*/*/61","*/28/61")
birthdate_tree.add_son("*/*/61","*/30/61")
birthdate_tree.add_son("*/*/61","*/21/61")
birthdate_tree.add_son("*/*/61","*/25/61")
birthdate_tree.add_son("*/*/61","*/19/61")
birthdate_tree.add_son("*/*/61","*/01/61")
birthdate_tree.add_son("*/*/61","*/02/61")
birthdate_tree.add_son("*/*/61","*/27/61")
birthdate_tree.add_son("*/*/61","*/10/61")
birthdate_tree.add_son("*/*/61","*/24/61")
birthdate_tree.add_son("*/*/61","*/12/61")
birthdate_tree.add_son("*/*/61","*/22/61")
birthdate_tree.add_son("*/*/61","*/04/61")
birthdate_tree.add_son("*/*/61","*/13/61")
birthdate_tree.add_son("*/*/61","*/17/61")
birthdate_tree.add_son("*/*/61","*/03/61")
birthdate_tree.add_son("*/*/61","*/07/61")
birthdate_tree.add_son("*/*/61","*/31/61")
birthdate_tree.add_son("*/*/61","*/29/61")
birthdate_tree.add_son("*/*/61","*/23/61")
birthdate_tree.add_son("*/*/61","*/11/61")
birthdate_tree.add_son("*/*/61","*/18/61")
birthdate_tree.add_son("*/*/61","*/16/61")
birthdate_tree.add_son("*/*/61","*/20/61")

birthdate_tree.add_son("*/27/64","09/27/64")
birthdate_tree.add_son("*/30/64","09/30/64")
birthdate_tree.add_son("*/18/64","04/18/64")
birthdate_tree.add_son("*/15/64","04/15/64")
birthdate_tree.add_son("*/13/64","09/13/64")
birthdate_tree.add_son("*/07/64","09/07/64")
birthdate_tree.add_son("*/28/64","04/28/64")
birthdate_tree.add_son("*/06/64","09/06/64")
birthdate_tree.add_son("*/29/64","04/29/64")
birthdate_tree.add_son("*/05/64","09/05/64")
birthdate_tree.add_son("*/03/64","09/03/64")
birthdate_tree.add_son("*/20/64","04/20/64")
birthdate_tree.add_son("*/11/64","09/11/64")
birthdate_tree.add_son("*/12/64","04/12/64")
birthdate_tree.add_son("*/10/64","04/10/64")
birthdate_tree.add_son("*/08/64","09/08/64")
birthdate_tree.add_son("*/19/64","09/19/64")
birthdate_tree.add_son("*/30/64","04/30/64")
birthdate_tree.add_son("*/09/64","04/09/64")
birthdate_tree.add_son("*/23/64","04/23/64")
birthdate_tree.add_son("*/04/64","09/04/64")
birthdate_tree.add_son("*/15/64","09/15/64")
birthdate_tree.add_son("*/16/64","04/16/64")
birthdate_tree.add_son("*/21/64","04/21/64")
birthdate_tree.add_son("*/25/64","09/25/64")
birthdate_tree.add_son("*/04/64","04/04/64")
birthdate_tree.add_son("*/27/64","04/27/64")
birthdate_tree.add_son("*/13/64","04/13/64")
birthdate_tree.add_son("*/03/64","04/03/64")
birthdate_tree.add_son("*/14/64","04/14/64")
birthdate_tree.add_son("*/26/64","04/26/64")
birthdate_tree.add_son("*/24/64","04/24/64")
birthdate_tree.add_son("*/17/64","04/17/64")
birthdate_tree.add_son("*/22/64","04/22/64")
birthdate_tree.add_son("*/19/64","04/19/64")
birthdate_tree.add_son("*/07/64","04/07/64")
birthdate_tree.add_son("*/06/64","04/06/64")
birthdate_tree.add_son("*/25/64","04/25/64")
birthdate_tree.add_son("*/11/64","04/11/64")
birthdate_tree.add_son("*/02/64","04/02/64")
birthdate_tree.add_son("*/05/64","04/05/64")
birthdate_tree.add_son("*/08/64","04/08/64")
birthdate_tree.add_son("*/01/64","04/01/64")
birthdate_tree.add_son("*/20/64","09/20/64")
birthdate_tree.add_son("*/12/64","09/12/64")
birthdate_tree.add_son("*/24/64","09/24/64")
birthdate_tree.add_son("*/21/64","09/21/64")
birthdate_tree.add_son("*/10/64","09/10/64")
birthdate_tree.add_son("*/14/64","09/14/64")
birthdate_tree.add_son("*/02/64","09/02/64")
birthdate_tree.add_son("*/17/64","09/17/64")
birthdate_tree.add_son("*/28/64","09/28/64")
birthdate_tree.add_son("*/26/64","09/26/64")
birthdate_tree.add_son("*/29/64","09/29/64")
birthdate_tree.add_son("*/01/64","09/01/64")
birthdate_tree.add_son("*/16/64","09/16/64")
birthdate_tree.add_son("*/23/64","09/23/64")
birthdate_tree.add_son("*/22/64","09/22/64")
birthdate_tree.add_son("*/09/64","09/09/64")
birthdate_tree.add_son("*/18/64","09/18/64")

birthdate_tree.add_son("*/13/63","03/13/63")
birthdate_tree.add_son("*/18/63","03/18/63")
birthdate_tree.add_son("*/05/63","03/05/63")
birthdate_tree.add_son("*/11/63","03/11/63")
birthdate_tree.add_son("*/15/63","03/15/63")
birthdate_tree.add_son("*/07/63","03/07/63")
birthdate_tree.add_son("*/06/63","03/06/63")
birthdate_tree.add_son("*/19/63","03/19/63")
birthdate_tree.add_son("*/27/63","03/27/63")
birthdate_tree.add_son("*/28/63","03/28/63")
birthdate_tree.add_son("*/30/63","03/30/63")
birthdate_tree.add_son("*/09/63","03/09/63")
birthdate_tree.add_son("*/04/63","03/04/63")
birthdate_tree.add_son("*/08/63","03/08/63")
birthdate_tree.add_son("*/17/63","03/17/63")
birthdate_tree.add_son("*/01/63","03/01/63")
birthdate_tree.add_son("*/10/63","03/10/63")
birthdate_tree.add_son("*/14/63","03/14/63")
birthdate_tree.add_son("*/16/63","03/16/63")
birthdate_tree.add_son("*/25/63","03/25/63")
birthdate_tree.add_son("*/03/63","03/03/63")
birthdate_tree.add_son("*/22/63","03/22/63")
birthdate_tree.add_son("*/02/63","03/02/63")
birthdate_tree.add_son("*/29/63","03/29/63")
birthdate_tree.add_son("*/23/63","03/23/63")
birthdate_tree.add_son("*/26/63","03/26/63")
birthdate_tree.add_son("*/12/63","03/12/63")
birthdate_tree.add_son("*/24/63","03/24/63")
birthdate_tree.add_son("*/21/63","03/21/63")
birthdate_tree.add_son("*/20/63","03/20/63")
birthdate_tree.add_son("*/31/63","03/31/63")

birthdate_tree.add_son("*/14/61","05/14/61")
birthdate_tree.add_son("*/05/61","05/05/61")
birthdate_tree.add_son("*/08/61","05/08/61")
birthdate_tree.add_son("*/15/61","09/15/61")
birthdate_tree.add_son("*/26/61","05/26/61")
birthdate_tree.add_son("*/28/61","05/28/61")
birthdate_tree.add_son("*/06/61","05/06/61")
birthdate_tree.add_son("*/30/61","09/30/61")
birthdate_tree.add_son("*/21/61","09/21/61")
birthdate_tree.add_son("*/25/61","09/25/61")
birthdate_tree.add_son("*/19/61","05/19/61")
birthdate_tree.add_son("*/01/61","05/01/61")
birthdate_tree.add_son("*/02/61","09/02/61")
birthdate_tree.add_son("*/27/61","05/27/61")
birthdate_tree.add_son("*/09/61","05/09/61")
birthdate_tree.add_son("*/25/61","05/25/61")
birthdate_tree.add_son("*/10/61","09/10/61")
birthdate_tree.add_son("*/24/61","09/24/61")
birthdate_tree.add_son("*/12/61","05/12/61")
birthdate_tree.add_son("*/22/61","09/22/61")
birthdate_tree.add_son("*/04/61","05/04/61")
birthdate_tree.add_son("*/13/61","05/13/61")
birthdate_tree.add_son("*/17/61","05/17/61")
birthdate_tree.add_son("*/03/61","09/03/61")
birthdate_tree.add_son("*/07/61","05/07/61")
birthdate_tree.add_son("*/15/61","05/15/61")
birthdate_tree.add_son("*/31/61","05/31/61")
birthdate_tree.add_son("*/29/61","05/29/61")
birthdate_tree.add_son("*/23/61","05/23/61")
birthdate_tree.add_son("*/11/61","05/11/61")
birthdate_tree.add_son("*/18/61","05/18/61")
birthdate_tree.add_son("*/30/61","05/30/61")
birthdate_tree.add_son("*/24/61","05/24/61")
birthdate_tree.add_son("*/10/61","05/10/61")
birthdate_tree.add_son("*/02/61","05/02/61")
birthdate_tree.add_son("*/16/61","05/16/61")
birthdate_tree.add_son("*/22/61","05/22/61")
birthdate_tree.add_son("*/20/61","05/20/61")
birthdate_tree.add_son("*/03/61","05/03/61")
birthdate_tree.add_son("*/21/61","05/21/61")
birthdate_tree.add_son("*/06/61","09/06/61")
birthdate_tree.add_son("*/11/61","09/11/61")
birthdate_tree.add_son("*/17/61","09/17/61")
birthdate_tree.add_son("*/23/61","09/23/61")
birthdate_tree.add_son("*/28/61","09/28/61")
birthdate_tree.add_son("*/05/61","09/05/61")
birthdate_tree.add_son("*/14/61","09/14/61")
birthdate_tree.add_son("*/16/61","09/16/61")
birthdate_tree.add_son("*/26/61","09/26/61")
birthdate_tree.add_son("*/13/61","09/13/61")
birthdate_tree.add_son("*/19/61","09/19/61")
birthdate_tree.add_son("*/09/61","09/09/61")
birthdate_tree.add_son("*/20/61","09/20/61")
birthdate_tree.add_son("*/01/61","09/01/61")
birthdate_tree.add_son("*/07/61","09/07/61")
birthdate_tree.add_son("*/29/61","09/29/61")
birthdate_tree.add_son("*/12/61","09/12/61")
birthdate_tree.add_son("*/04/61","09/04/61")
birthdate_tree.add_son("*/08/61","09/08/61")
birthdate_tree.add_son("*/18/61","09/18/61")
birthdate_tree.add_son("*/27/61","09/27/61")

# zipcode
zipcode_tree = GeneralizationTreeNode("941**")
zipcode_tree.add_son("941**","9413*")
zipcode_tree.add_son("941**","9414*")

zipcode_tree.add_son("9413*","94139")
zipcode_tree.add_son("9413*","94138")
zipcode_tree.add_son("9414*","94141")
zipcode_tree.add_son("9414*","94142")

# sex
sex_tree = GeneralizationTreeNode("person")
sex_tree.add_son("person","male")
sex_tree.add_son("person","female")

#status
status_tree = GeneralizationTreeNode("unspecified")
status_tree.add_son("unspecified","divorced")
status_tree.add_son("unspecified","married")
status_tree.add_son("unspecified","single")
status_tree.add_son("unspecified","widow")


generalization_forest = {
'race' : race_tree,
'birth' : birthdate_tree,
'sex' : sex_tree,
'zip' : zipcode_tree,
'status' : status_tree
}

start=datetime.datetime.now()
incognito_algorithm = Incognito(generalization_forest)
kanonymous_data = incognito_algorithm(data, 2, [0,6])
with pd.option_context('display.max_rows', None, 'display.max_columns', None):  # more options can be specified also
    print(kanonymous_data)
end=datetime.datetime.now()
print("time duration: {}".format(end-start))
